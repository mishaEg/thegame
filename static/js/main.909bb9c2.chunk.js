(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e){e.exports={emptySpace:{icon:" "},wall:{icon:"wall"},floor:{icon:"floor"},grass:{icon:"grass"},gem:{type:"money",name:"gem",cost:10,icon:"gem"},sword:{name:"wooden sword",type:"weapon",icon:"sword",damage:18},iron_sword:{name:"iron sword",type:"weapon",icon:"iron_sword",damage:50},shield:{name:"wooden shield",type:"shield",icon:"shield",defence:2},iron_shield:{name:"iron shield",type:"shield",icon:"iron_shield",defence:20},ectoplasma:{type:"food",name:"ectoplasma",icon:"ectoplasma"}}},19:function(e){e.exports=[["=","=","=","=","=","=","=","=","=","="," "," ","=","=","=","=","=","=","=","=","=","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","=","=","=","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","=","=","=","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","=","=","=","=","=","=","=","=","="," "," ","=","=","=","=","=","=","=","=","=","="]]},21:function(e,t,n){e.exports=n(47)},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(17),s=n.n(o),r=n(3),c=n(4),h=n(7),u=n(6),l=n(8),p=n(18),f=n.n(p);var d=n(1);function m(e,t){return Math.floor(Math.random()*(t-e+1))+e}function y(e,t,n){for(var a=d.floor,i=0;i<t;i++){var o=m(2,e[0].length-1),s=m(2,e.length-1),r=e[s][o].length-1;e[s][o][r].icon===a.icon?e[s][o].push(n):i--}}var v=n(19);function g(){var e=function(e){var t=d.floor,n=d.wall,a=d.emptySpace;return e.map(function(e){return e.map(function(e){switch(e){case"=":return[n];case"*":return[t];default:return[a]}})})}(v);return y(e,1,d.sword),y(e,1,d.shield),y(e,2,d.grass),e}var k=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).heroStats=function(){var e=n.props.hero;return e?"health: ".concat(e.health," | weapon: ").concat(e.weapon.name," | shield: ").concat(e.shield.name," | money: ").concat(e.money):null},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.message;return i.a.createElement("div",{className:"message_bar"},this.heroStats(),i.a.createElement("br",null),e)}}]),t}(a.Component),w=function(){function e(t,n){Object(r.a)(this,e),this.positionX=n,this.positionY=t,this.icon="hero",this.health=100,this.damage=2,this.defence=0,this.money=0,this.weapon={name:"none"},this.shield={name:"none"},this.countOfPoison=0,this.readyToMine=!1}return Object(c.a)(e,[{key:"effectsHandler",value:function(){this.countOfPoison>0&&(this.health-=this.countOfPoison)}},{key:"eat",value:function(){this.health+=100,this.countOfPoison+=1}},{key:"takeWeapon",value:function(e){this.weapon=e,this.damage+=e.damage}},{key:"dropWeapon",value:function(){this.damage-=this.weapon.damage,this.weapon={name:"none"}}},{key:"takeShield",value:function(e){this.shield=e,this.defence+=e.defence}},{key:"dropShield",value:function(){this.defence-=this.shield.defence,this.shield={name:"none"}}},{key:"changeCoordinates",value:function(e,t){this.positionX=e,this.positionY=t}}]),e}(),b=n(15),E=n.n(b);function O(e,t){return e.positionX===t.positionX&&e.positionY===t.positionY}var x=function(e,t,n){n.forEach(function(a){"sleeping"===a.status?a.regeneration():function(e,t,n,a){var i=[-1,-1,-1,0,0,0,1,1,1];[0,1,-1,0,1,-1,0,1,-1].forEach(function(t,a){if(O({positionX:e.positionX+i[a],positionY:e.positionY+t},n)){var o=e.damage-n.defence;o>0&&(n.health-=o)}});var o=function(e,t){return e.map(function(e,n){return e.map(function(e,a){var i=e[e.length-1].icon,o=!1;return t.forEach(function(e){e.positionY===n&&e.positionX===a&&(o=!0)}),"wall"===i||o?1:0})})}(t,a),s=new E.a.AStarFinder,r=new E.a.Grid(o),c=s.findPath(e.positionX,e.positionY,n.positionX,n.positionY,r);0===c.length||c[1][0]===n.positionX&&c[1][1]===n.positionY||e.move(c[1][0],c[1][1])}(a,t,e,n)})},Y=function(){function e(t,n){Object(r.a)(this,e),this.positionX=t,this.positionY=n,this.icon="sleeping_enemy",this.health=100,this.depthOfSleep=2,this.stamina=0,this.damage=50,this.status="sleeping",this.type="enemy"}return Object(c.a)(e,[{key:"wakedUp",value:function(){this.status="awake",this.icon="awaken_enemy",this.stamina=20,this.depthOfSleep=0}},{key:"fallAsleep",value:function(){this.status="sleeping",this.icon="sleeping_enemy",this.depthOfSleep=2}},{key:"regeneration",value:function(){this.health<100&&this.health>0&&(this.health+=1,this.checkTemper())}},{key:"checkTemper",value:function(){if("sleeping"!==this.status)switch(!0){case this.health>=50&&this.health<90:this.irritation();break;case this.health>=20&&this.health<50:this.rage();break;case this.health<20:this.humility()}}},{key:"getDamage",value:function(e){if(!+e)throw new Error("damage is not a number");this.health=this.health-e,this.health<=0?this.dead():(1===this.depthOfSleep&&this.wakedUp(),this.checkTemper(),0!==this.depthOfSleep&&(this.depthOfSleep-=1))}},{key:"irritation",value:function(){this.status="irritation",this.damage=60,this.stamina=30}},{key:"rage",value:function(){this.status="rage",this.damage=100,this.stamina=40}},{key:"humility",value:function(){this.status="humility",this.damage=10,this.stamina=6}},{key:"changePosition",value:function(e,t){this.positionX=e,this.positionY=t}},{key:"move",value:function(e,t){this.positionX=e,this.positionY=t,this.tired()}},{key:"dead",value:function(){this.status="dead"}},{key:"tired",value:function(){this.stamina>0?this.stamina-=2:0===this.stamina&&this.fallAsleep()}}]),e}();var X=function(e,t,n){var a=e[t][n].length;return e[t][n][a-1]};var S=function(e,t,n,a){var i=0,o=0,s=!1,r=!1;switch(n){case"left":i=-1;break;case"right":i=1;break;case"up":o=-1;break;case"down":o=1;break;default:throw new Error("key is not correct:"+n)}var c=t.positionX+i,h=t.positionY+o,u=d.ectoplasma,l=X(e,h,c);if(a.forEach(function(n,a,i){if(O({positionX:c,positionY:h},n)){var o=function(e,t){var n="you punch enemy",a=!1;if("sleeping"===t.status)2===t.depthOfSleep?n="you punch sleeping enemy, once more punch for waked up":1===t.depthOfSleep&&(n="you punch sleeping enemy and woke him up"),t.getDamage(e.damage);else{var i=t.status;if(t.getDamage(e.damage),i!==t.status)switch(t.status){case"irritation":n="you punch enemy and he became irritated";break;case"rage":n="you punch enemy and he became raged";break;case"humility":n="you punch enemy and he became humble"}}return"dead"===t.status&&(n="you punch enemy and kill him",a=!0),{isDied:a,fightMessage:n}}(t,n),l=o.fightMessage,p=o.isDied;r=!0,s=l,p&&(e[h][c].push(u),i.splice(a,1))}}),!r)switch(l.icon){case"wall":s="there is no the way";break;case" ":s="Its whitespace? how did you do this?? (bug!)";break;case"grass":s="you stay at grass and feels fresh green leaves by your feet :\u0437.",t.changeCoordinates(c,h);break;default:l.type&&(s="you stay at "+l.name+', if you wanna pick it up, press "p"'),t.changeCoordinates(c,h)}return s},j=n(20);var P=function(e,t,n,a,i,o,s,r){var c=d.emptySpace;n.forEach(function(n,h){var u=e.y+n,l=e.x+t[h];if(void 0===a[u])for(var p=function(){var t=[];a[i.positionY].forEach(function(){t.push([c])}),t[l]=[o],u<0?(a.unshift(t),i.positionY+=1,e.y+=1,u+=1,r.forEach(function(e){e.positionY+=1})):u>a.length-1&&a.push(t)};u<0||u>a.length-1;)p();else if(void 0===a[u][l]){for(;l<0||l>a[u].length-1;)l<0?(a.forEach(function(e){e.unshift([c])}),r.forEach(function(e){e.positionX+=1}),a[u][0][0]=o,i.positionX+=1,e.x+=1,l+=1):a.forEach(function(e){e.push([c])});a[u][l][0]=o}else s.forEach(function(e){a[u][l][0].icon===e.icon&&(a[u][l][0]=o)})})};var _=function(e,t,n,a,i){var o=d.floor,s=d.emptySpace,r=d.wall,c=d.gem;P(e,[-1,-1,-1,0,0,0,1,1,1],[0,1,-1,0,1,-1,0,1,-1],n,a,r,[s],i),P(e,[0],[0],n,a,o,[r],i);var h=!1;return t&&0===m(0,9)&&(n[e.y][e.x].push(c),h="you found a gem!"),h};function M(e,t){for(var n=[-1,-1,-1,0,0,0,1,1,1],a=[0,1,-1,0,1,-1,0,1,-1],i=0;i<=a.length-1;i++){var o=e.y+a[i],s=e.x+n[i];if(void 0!==t[o]&&void 0!==t[o][s]&&" "!==t[o][s][0].icon)return!1}return!0}var T=function(e,t,n,a,i){var o=!1,s=function(e,t,n){var a=Object(j.a)({},e),i=[0,-1,1],o=[0,-1,1];switch(t){case"left":a.x-=2,o=[];break;case"right":a.x+=2,o=[];break;case"up":a.y-=2,i=[];break;case"down":a.y+=2,i=[];break;default:throw new Error("direction is not a correct:"+t)}if(0===i.length){for(var s=0;s<=o.length-1;s++)if(M({x:a.x+o[s],y:a.y},n))return{clear:!0,shift:o[s]}}else for(var r=0;r<=i.length-1;r++)if(M({x:a.x,y:a.y+i[r]},n))return{clear:!0,shift:i[r]};return{clear:!1}}(e,t,n);return!0===s.clear&&(function(e,t,n){switch(t){case"left":e.x-=2,e.y+=n;break;case"right":e.x+=2,e.y+=n;break;case"up":e.y-=2,e.x+=n;break;case"down":e.y+=2,e.x+=n;break;default:throw new Error("direction is not a correct:"+t)}}(e,t,s.shift),o=function(e,t,n,a){var i,o,s=d.floor,r=d.emptySpace,c=d.wall,h=d.grass,u=d.iron_sword,l=d.iron_shield,p=m(0,7);switch(!0){case 2===p||3===p:o="you found cave with enemy!",i="enemy";break;case 4===p||5===p:o="you found cave with grass!",i="grass";break;case 6===p:o="you found cave with iron shield!",i="iron shield";break;case 7===p:o="you found cave with iron sword!",i="iron sword";break;default:o="you found empty cave",i="none"}switch(P(e,[-1,-1,-1,0,0,0,1,1,1],[0,1,-1,0,1,-1,0,1,-1],t,n,s,[r,c],a),P(e,[-1,0,1,-2,2,-2,2,-2,2,-2,2,-2,-1,0,1,2],[2,2,2,2,2,1,1,0,0,-1,-1,-2,-2,-2,-2,-2],t,n,c,[r],a),i){case"enemy":a.push(new Y(e.x,e.y));break;case"grass":t[e.y][e.x].push(h);break;case"iron sword":t[e.y][e.x].push(u);break;case"iron shield":t[e.y][e.x].push(l);break;case"none":break;default:throw new Error("Treasure is not correct: ".concat(i))}return o}(e,n,a,i),function(e,t,n){switch(t){case"left":e.x+=2,e.y-=n;break;case"right":e.x-=2,e.y-=n;break;case"up":e.y+=2,e.x-=n;break;case"down":e.y-=2,e.x-=n;break;default:throw new Error("direction is not a correct:"+t)}}(e,t,s.shift)),_(e,!1,n,a,i),o};var H=function(e,t,n,a){return t.readyToMine?function(e,t,n,a){var i=0,o=0,s="there is nothing to dig";switch(t.readyToMine=!1,n){case"left":i=-1;break;case"right":i=1;break;case"up":o=-1;break;case"down":o=1;break;default:throw new Error("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 direction:"+n)}var r={x:t.positionX+i,y:t.positionY+o};return"wall"!==X(e,r.y,r.x).icon?s:s=0===m(0,4)?T(r,n,e,t,a):_(r,!0,e,t,a)}(e,t,n,a):S(e,t,n,a)};function W(e,t,n,a){var i;switch(a){case"p":i=function(e,t){var n,a=X(e,t.positionY,t.positionX);switch(a.type){case"money":t.money+=10,e[t.positionY][t.positionX].pop(),n="you raised money and take 10 gold! ^_^";break;case"shield":if("none"!==t.shield.name){var i=t.shield;t.dropShield(),t.takeShield(a),e[t.positionY][t.positionX].pop(),e[t.positionY][t.positionX].push(i)}else t.takeShield(a),e[t.positionY][t.positionX].pop();n="you raised "+a.name+"!";break;case"weapon":if("none"!==t.weapon.name){var o=t.weapon;t.dropWeapon(),t.takeWeapon(a),e[t.positionY][t.positionX].pop(),e[t.positionY][t.positionX].push(o)}else t.takeWeapon(a),e[t.positionY][t.positionX].pop();n="you raised "+a.name+"!";break;case"food":t.eat(),e[t.positionY][t.positionX].pop(),n="you picked up and eat "+a.name+", but feel bad";break;default:n="no items to take"}return n}(t,e);break;case"d":"none"!==e.weapon.name?(e.readyToMine=!e.readyToMine,i=e.readyToMine?"you rised the pickaxe (".concat(e.weapon.name,"). Now, choose direction to dig"):"you lower the pickaxe (".concat(e.weapon.name,")")):i="you need any weapon to dig";break;default:i=H(t,e,a,n)}return e.effectsHandler(),i}var C=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(h.a)(this,Object(u.a)(t).call(this))).componentWillMount=function(){var t=g(),n=function(e){for(var t,n,a=d.floor,i=!1;!i;){t=m(2,e[0].length-1);var o=e[n=m(2,e.length-1)][t].length-1;e[n][t][o].icon===a.icon&&(i=!0)}return{x:t,y:n}}(t),a=new Y(n.x,n.y),i=e.state.creatures;i.push(a),e.setState({map:t,creatures:i})},e.componentWillReceiveProps=function(t){var n=t.keyPress;null!==n&&e.handleKeyPressed(n)},e.handleKeyPressed=function(t){var n=e.state,a=n.map,i=n.hero,o=n.creatures,s=n.onHelp;if("h"!==t){var r=W(i,a,o,t);x(i,a,o),e.setState({hero:i,map:a,message:r,creatures:o})}else e.setState({onHelp:!s})},e.state={onHelp:!1,message:"press h for help menu",hero:new w(2,2),creatures:[]},e}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.map,n=e.hero,a=e.message,o=e.creatures,s=e.onHelp,r=[];return t&&(r=function(e,t,n){var a=e.map(function(e){return e.map(function(e){return e[e.length-1].icon})});return a[t.positionY][t.positionX]=t.icon,n.forEach(function(e){a[e.positionY][e.positionX]=e.icon}),a.map(function(e,t){return i.a.createElement("tr",{key:t},e.map(function(e,t){return i.a.createElement("td",{key:t},i.a.createElement("div",{className:"map_object ".concat(e)}))}))})}(t,n,o)),i.a.createElement("div",null,s?i.a.createElement("div",null,i.a.createElement("h1",null,"||HELP||"),i.a.createElement("h3",null,"1. for moving use arrow keys"),i.a.createElement("h3",null,'2. for digging use "d" key. Works only if you have any weapon'),i.a.createElement("h3",null,'3. for close help menu press "h" key again')):i.a.createElement("div",null,i.a.createElement(k,{hero:n,message:a}),i.a.createElement("table",null,i.a.createElement("tbody",null,r))))}}]),t}(a.Component),K=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(h.a)(this,Object(u.a)(t).call(this))).handleKeyPressed=function(t){e.setState({keyPress:t})},e.state={keyPress:null},e}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=["down","left","right","up","h","p","d"],n=this.state,a=n.onHelp,o=n.keyPress;return a&&(t=["h"]),i.a.createElement("div",null,i.a.createElement(f.a,{handleKeys:t,onKeyEvent:function(t){return e.handleKeyPressed(t)}}),i.a.createElement(C,{keyPress:o}))}}]),t}(a.Component);n(46);s.a.render(i.a.createElement(K,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.909bb9c2.chunk.js.map