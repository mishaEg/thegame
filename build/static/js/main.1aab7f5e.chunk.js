(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e){e.exports={emptySpace:{icon:" "},wall:{icon:"wall"},floor:{icon:"floor"},grass:{icon:"grass"},gem:{type:"money",cost:10,icon:"gem"},sword:{name:"wooden sword",type:"weapon",icon:"sword",damage:18},iron_sword:{name:"iron sword",type:"weapon",icon:"iron_sword",damage:50},shield:{name:"wooden shield",type:"shield",icon:"shield",defence:2},iron_shield:{name:"iron shield",type:"shield",icon:"iron_shield",defence:20},ectoplasma:{type:"food",name:"ectoplasma",icon:"ectoplasma"}}},21:function(e){e.exports=[["=","=","=","=","=","=","=","=","=","="," "," ","=","=","=","=","=","=","=","=","=","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","=","=","=","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","=","=","=","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","*","*","*","*","*","*","*","*","="," "," ","=","*","*","*","*","*","*","*","*","="],["=","=","=","=","=","=","=","=","=","="," "," ","=","=","=","=","=","=","=","=","=","="]]},22:function(e,t,a){e.exports=a(48)},47:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(19),r=a.n(i),s=a(5),c=a(6),u=a(9),h=a(8),p=a(10),d=a(20),l=a.n(d);var f=a(1);function m(e,t){return Math.floor(Math.random()*(t-e+1))+e}function y(e,t,a){for(var n=f.floor,o=0;o<t;o++){var i=m(2,e[0].length-1),r=m(2,e.length-1),s=e[r][i].length-1;e[r][i][s].icon===n.icon?e[r][i].push(a):o--}}var v=a(21);function g(){var e=function(e){var t=f.floor,a=f.wall,n=f.emptySpace;return e.map(function(e){return e.map(function(e){switch(e){case"=":return[a];case"*":return[t];default:return[n]}})})}(v);return y(e,1,f.sword),y(e,1,f.shield),y(e,2,f.grass),e}var b=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).heroStats=function(){var e=a.props.hero;return e?"health: ".concat(e.health," | weapon: ").concat(e.weapon.name," | shield: ").concat(e.shield.name," | money: ").concat(e.money):null},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.message;return o.a.createElement("div",{className:"message_bar"},this.heroStats(),o.a.createElement("br",null),e)}}]),t}(n.Component),w=function(){function e(t,a){Object(s.a)(this,e),this.positionX=a,this.positionY=t,this.icon="hero",this.health=100,this.damage=2,this.defence=0,this.money=0,this.weapon={name:"none"},this.shield={name:"none"},this.countOfPoison=0,this.readyToMine=!1}return Object(c.a)(e,[{key:"effectsHandler",value:function(){this.countOfPoison>0&&(this.health-=this.countOfPoison)}},{key:"eat",value:function(){this.health+=100,this.countOfPoison+=1}},{key:"takeWeapon",value:function(e){this.weapon=e,this.damage+=e.damage}},{key:"takeShield",value:function(e){this.shield=e,this.defence+=e.defence}}]),e}(),k=a(2),O=a(3),j=a(17),E=a.n(j);function C(e,t){return e.positionX===t.positionX&&e.positionY===t.positionY}function M(e,t,a,n){var o=[-1,-1,-1,0,0,0,1,1,1];[0,1,-1,0,1,-1,0,1,-1].forEach(function(t,n){if(C({positionX:e.positionX+o[n],positionY:e.positionY+t},a)){var i=function(e,t){return{damagedHero:Object(O.a)({},t,{health:t.health-e.damage})}}(e,a).damagedHero;a=i}});var i=function(e,t){return e.map(function(e,a){return e.map(function(e,n){var o=e[e.length-1].icon,i=!1;return t.forEach(function(e){e.positionY===a&&e.positionX===n&&(i=!0)}),"wall"===o||i?1:0})})}(t,n),r=new E.a.AStarFinder,s=new E.a.Grid(i),c=r.findPath(e.positionX,e.positionY,a.positionX,a.positionY,s);return 0===c.length||c[1][0]===a.positionX&&c[1][1]===a.positionY||e.move(c[1][0],c[1][1]),{updatedHero:Object(O.a)({},a),updatedCreature:e}}var X=function(e,t,a){var n=a.map(function(n){if("sleeping"===n.status)return n.regeneration(),n;var o=a.filter(function(e){return e!==n}),i=M(n,t,e,o),r=i.updatedHero,s=i.updatedCreature;return e=r,s});return{updatedCreatures:Object(k.a)(n),updatedHero:Object(O.a)({},e)}},Y=function(){function e(t,a){Object(s.a)(this,e),this.positionX=t,this.positionY=a,this.icon="sleeping_enemy",this.health=100,this.depthOfSleep=2,this.stamina=0,this.damage=50,this.status="sleeping",this.type="enemy"}return Object(c.a)(e,[{key:"wakedUp",value:function(){this.status="awake",this.icon="awaken_enemy",this.stamina=20,this.depthOfSleep=0}},{key:"fallAsleep",value:function(){this.status="sleeping",this.icon="sleeping_enemy",this.depthOfSleep=2}},{key:"regeneration",value:function(){this.health<100&&this.health>0&&(this.health+=1,this.checkTemper())}},{key:"checkTemper",value:function(){if("sleeping"!==this.status)switch(!0){case this.health>=50&&this.health<90:this.irritation();break;case this.health>=20&&this.health<50:this.rage();break;case this.health<20:this.humility()}}},{key:"getDamage",value:function(e){if(!+e)throw new Error("damage is not a number");this.health=this.health-e,this.health<=0?this.dead():(1===this.depthOfSleep&&this.wakedUp(),this.checkTemper(),0!==this.depthOfSleep&&(this.depthOfSleep-=1))}},{key:"irritation",value:function(){this.status="irritation",this.damage=60,this.stamina=30}},{key:"rage",value:function(){this.status="rage",this.damage=100,this.stamina=40}},{key:"humility",value:function(){this.status="humility",this.damage=10,this.stamina=6}},{key:"changePosition",value:function(e,t){this.positionX=e,this.positionY=t}},{key:"move",value:function(e,t){this.positionX=e,this.positionY=t,this.tired()}},{key:"dead",value:function(){this.status="dead"}},{key:"tired",value:function(){this.stamina>0?this.stamina-=2:0===this.stamina&&this.fallAsleep()}}]),e}();var S=function(e,t,a){var n=e[t][a].length;return e[t][a][n-1]};var H=function(e,t,a,n){var o=0,i=0,r=!1,s=!1,c=!1,u=!1;switch(a){case"left":o=-1;break;case"right":o=1;break;case"up":i=-1;break;case"down":i=1;break;default:throw new Error("key is not correct:"+a)}var h=t.positionX+o,p=t.positionY+i,d=S(e,p,h),l=n.reduce(function(a,n){if(C({positionX:h,positionY:p},n)){var o=function(e,t){var a="you punch enemy",n=!1;if("sleeping"===t.status)2===t.depthOfSleep?a="you punch sleeping enemy, once more punch for waked up":1===t.depthOfSleep&&(a="you punch sleeping enemy and woke him up"),t.getDamage(e.damage);else{var o=t.status;if(t.getDamage(e.damage),o!==t.status)switch(t.status){case"irritation":a="you punch enemy and he became irritated";break;case"rage":a="you punch enemy and he became raged";break;case"humility":a="you punch enemy and he became humble"}}return"dead"===t.status&&(a="you punch enemy and kill him",n=!0),{isDied:n,fightMessage:a}}(t,n),i=o.fightMessage,u=o.isDied,d=f.ectoplasma;s=!0,r=i,u?(c=!0,e[p][h].push(d)):a.push(n)}else a.push(n);return a},[]);if(!s)switch(d.icon){case"wall":r="there is no the way";break;case" ":r="Its whitespace? how did you do this?? (bug!)";break;case"grass":u=!0,r="you stay at "+d.icon+" and feels fresh green leaves by your foots :\u0437.";break;default:d.type&&(r="you stay at "+d.icon+', if you wanna pick it up, press "p"'),u=!0}var m=c?e:[];return{message:r,movedHero:Object(O.a)({},t,{positionX:u?h:t.positionX,positionY:u?p:t.positionY}),updatedMap:m,updatedCreatures:l}};var x=function(e,t,a,n,o,i,r,s){var c=Object(k.a)(n),u=Object(k.a)(s),h=Object(k.a)(r),p=f.emptySpace,d=e.x,l=e.y,m=o.positionX,y=o.positionY;return a.forEach(function(e,a){var n=l+e,o=d+t[a];if(void 0===c[n])for(var r=function(){var e=[];c[y].forEach(function(){e.push([p])}),e[o]=[i],n<0?(c.unshift(e),y+=1,l+=1,n+=1,u.forEach(function(e){e.positionY+=1})):n>c.length-1&&c.push(e)};n<0||n>c.length-1;)r();else if(void 0===c[n][o]){for(;o<0||o>c[n].length-1;)o<0?(c.forEach(function(e){e.unshift([p])}),u.forEach(function(e){e.positionX+=1}),c[n][0][0]=i,m+=1,d+=1,o+=1):c.forEach(function(e){e.push([p])});c[n][o][0]=i}else h.forEach(function(e){c[n][o][0].icon===e.icon&&(c[n][o][0]=i)})}),{updatedTargetCoordinates:{x:d,y:l},map:[].concat(c),hero:Object(O.a)({},o,{positionX:m,positionY:y}),creatures:[].concat(u)}};var P=function(e,t,a,n,o){var i=f.floor,r=f.emptySpace,s=f.wall,c=f.gem,u=x(e,[-1,-1,-1,0,0,0,1,1,1],[0,1,-1,0,1,-1,0,1,-1],a,n,s,[r],o),h=u.updatedTargetCoordinates,p=u.map,d=u.hero,l=u.creatures,y=x(h,[0],[0],p,d,i,[s],l),v=y.updatedTargetCoordinates,g=y.map,b=y.hero,w=y.creatures,j=!1;return t&&0===m(0,9)&&(g[h.y][h.x].push(c),j="you found a gem!"),{updateDiggingCoordinate:Object(O.a)({},v),map:Object(k.a)(g),hero:Object(O.a)({},b),creatures:Object(k.a)(w),message:j}};var T=function(e,t,a,n,o,i){var r=P(e,!1,n,o,i),s=r.updateDiggingCoordinate,c=r.map,u=r.hero,h=r.creatures;switch(t){case"left":s.x-=2;break;case"right":s.x+=2;break;case"up":s.y-=2;break;case"down":s.y+=2;break;default:throw new Error("direction is not a correct:"+t)}var p=function(e,t,a,n,o){var i=f.floor,r=f.emptySpace,s=f.wall,c=f.grass,u=f.iron_sword,h=f.iron_shield,p=x(e,[-1,-1,-1,0,0,0,1,1,1],[0,1,-1,0,1,-1,0,1,-1],a,n,i,[r,s],o),d=p.updatedTargetCoordinates,l=p.map,m=p.hero,y=p.creatures,v=x(d,[-1,0,1,-2,2,-2,2,-2,2,-2,2,-2,-1,0,1,2],[2,2,2,2,2,1,1,0,0,-1,-1,-2,-2,-2,-2,-2],l,m,s,[r],y),g=v.updatedTargetCoordinates,b=v.map,w=v.hero,j=v.creatures,E=Object(k.a)(j);switch(t){case"enemy":E=[].concat(Object(k.a)(E),[new Y(g.x,g.y)]);break;case"grass":b[g.y][g.x].push(c);break;case"iron sword":b[g.y][g.x].push(u);break;case"iron shield":b[g.y][g.x].push(h);break;case"none":break;default:throw new Error("Treasure is not correct: ".concat(t))}return{mapWithCave:Object(k.a)(b),heroOnMapWithCave:Object(O.a)({},w),creaturesOnMapWithCave:Object(k.a)(E)}}(s,a,c,u,h),d=p.mapWithCave,l=p.heroOnMapWithCave,m=p.creaturesOnMapWithCave;return{mapWithCave:Object(k.a)(d),heroOnMapWithCave:Object(O.a)({},l),creaturesOnMapWithCave:Object(k.a)(m)}};var W=function(e,t,a,n){var o,i=t,r=n,s=e;if(t.readyToMine){var c=function(e,t,a,n){var o=0,i=0;switch(a){case"left":o=-1;break;case"right":o=1;break;case"up":i=-1;break;case"down":i=1;break;default:throw new Error("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 direction:"+a)}var r={x:t.positionX+o,y:t.positionY+i},s=S(e,r.y,r.x),c={message:"there is nothing to dig",updatedCreatures:Object(k.a)(n),updatedHero:Object(O.a)({},t,{readyToMine:!1}),updatedMap:Object(k.a)(e)};if("wall"!==s.icon)return c;if(0===m(0,4)){var u=m(0,7),h="",p="";switch(!0){case 2===u||3===u:h="you found cave with enemy!",p="enemy";break;case 4===u||5===u:h="you found cave with grass!",p="grass";break;case 6===u:h="you found cave with iron shield!",p="iron shield";break;case 7===u:h="you found cave with iron sword!",p="iron sword";break;default:h="you found empty cave",p="none"}var d=T(r,a,p,e,t,n),l=d.mapWithCave,f=d.heroOnMapWithCave,y=d.creaturesOnMapWithCave;c=Object(O.a)({},c,{message:h,updatedMap:Object(k.a)(l),updatedHero:Object(O.a)({},f,{readyToMine:!1}),updatedCreatures:Object(k.a)(y)})}else{var v=P(r,!0,e,t,n),g=v.map,b=v.hero,w=v.creatures,j=v.message;c=Object(O.a)({},c,{message:j,updatedMap:Object(k.a)(g),updatedHero:Object(O.a)({},b,{readyToMine:!1}),updatedCreatures:Object(k.a)(w)})}return c}(e,t,a,n),u=c.message,h=c.updatedMap,p=c.updatedHero;r=c.updatedCreatures,s=h,i=p,o=u}else{var d=H(e,t,a,n),l=d.message,f=d.movedHero,y=d.updatedMap,v=d.updatedCreatures;0!==y.length&&(s=y),r=v,i=f,o=l}return{map:s,hero:i,message:o,creatures:r}};function _(e,t,a,n){var o;switch(n){case"p":o=function(e,t){var a,n=S(e,t.positionY,t.positionX);switch(n.type){case"money":t.money+=10,e[t.positionY][t.positionX].pop(),a="you raised money and take 10 gold! ^_^";break;case"shield":t.takeShield(n),e[t.positionY][t.positionX].pop(),a="you raised "+n.name+"!";break;case"weapon":t.takeWeapon(n),e[t.positionY][t.positionX].pop(),a="you raised "+n.name+" and increace your power!";break;case"food":t.eat(),e[t.positionY][t.positionX].pop(),a="you picked up and eat "+n.name+", but feel bad";break;default:a="no items to take"}return a}(t,e);break;case"d":"none"!==e.weapon.name?(e.readyToMine=!e.readyToMine,o=e.readyToMine?"you rised the pickaxe (".concat(e.weapon.name,"). Now, choose direction to dig"):"you lower the pickaxe (".concat(e.weapon.name,")")):o="you need any weapon to dig";break;default:var i=W(t,e,n,a);t=i.map,e=i.hero,o=i.message,a=i.creatures}return o}var D=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).componentWillMount=function(){var t=g(),a=function(e){for(var t,a,n=f.floor,o=!1;!o;){t=m(2,e[0].length-1);var i=e[a=m(2,e.length-1)][t].length-1;e[a][t][i].icon===n.icon&&(o=!0)}return{x:t,y:a}}(t),n=new Y(a.x,a.y),o=e.state.creatures;o.push(n),e.setState({map:t,creatures:o})},e.componentWillReceiveProps=function(t){var a=t.keyPress;null!==a&&e.handleKeyPressed(a)},e.handleKeyPressed=function(t){var a=e.state,n=a.map,o=a.hero,i=a.creatures,r=a.onHelp;if("h"!==t){var s=_(o,n,i,t).message,c=X(o,n,i),u=c.updatedHero,h=c.updatedCreatures;e.setState({hero:u,map:n,message:s,creatures:h})}else e.setState({onHelp:!r})},e.state={onHelp:!1,message:"",hero:new w(2,2),creatures:[]},e}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.map,a=e.hero,n=e.message,i=e.creatures,r=e.onHelp,s=[];return t&&(s=function(e,t,a){var n=e.map(function(e){return e.map(function(e){return e[e.length-1].icon})});return n[t.positionY][t.positionX]=t.icon,a.forEach(function(e){n[e.positionY][e.positionX]=e.icon}),n.map(function(e,t){return o.a.createElement("tr",{key:t},e.map(function(e,t){return o.a.createElement("td",{key:t},o.a.createElement("div",{className:"map_object ".concat(e)}))}))})}(t,a,i)),o.a.createElement("div",null,r?o.a.createElement("div",null,o.a.createElement("h1",null,"||HELP||"),o.a.createElement("h3",null,"1. for moving use arrow keys"),o.a.createElement("h3",null,'2. for digging use "d" key. Works only if you have any weapon'),o.a.createElement("h3",null,'3. for close help menu press "h" key again')):o.a.createElement("div",null,o.a.createElement(b,{hero:a,message:n}),o.a.createElement("table",null,o.a.createElement("tbody",null,s))))}}]),t}(n.Component),K=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).handleKeyPressed=function(t){e.setState({keyPress:t})},e.state={keyPress:null},e}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=["down","left","right","up","h","p","d"],a=this.state,n=a.onHelp,i=a.keyPress;return n&&(t=["h"]),o.a.createElement("div",null,o.a.createElement(l.a,{handleKeys:t,onKeyEvent:function(t){return e.handleKeyPressed(t)}}),o.a.createElement(D,{keyPress:i}))}}]),t}(n.Component);a(47);r.a.render(o.a.createElement(K,null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.1aab7f5e.chunk.js.map